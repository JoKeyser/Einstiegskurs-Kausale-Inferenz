---
title: "Modul 02: Ein Pfeil zeigt die Richtung"
output: 
  learnr::tutorial:
    progressive: true
    css: "css/style.css"
runtime: shiny_prerendered
---


```{r setup, include=FALSE}
library(learnr)
library(knitr)
library(ggplot2)

theme.fom <- theme_classic(22*1.04)
theme.fom <- theme.fom
theme_set(
  theme.fom  
)


library(ggdag)

# DAG
co <- data.frame(x=c(0,1), y=c(0,0), name=c("X", "Y"))
DAG1 <- dagify(Y~ X,
                   coords = co) %>% 
  ggdag() + 
  geom_dag_point(colour = c("#0F710B", "#0000FF")) + 
  geom_dag_text(size = 8) +
  theme_dag_blank() +
  geom_dag_edges(arrow_directed = grid::arrow(length = grid::unit(15, "pt"), type = "closed")) +
  geom_text(label = "X - Tablette\nY - Schmerzrückgang", 
            hjust = 1, vjust = 2,
            x = 1, y = 0, size = 7, color = "darkgrey") 
```

## Lernziele

In diesem Modul lernen Sie:

- Was unter Ursache und Wirkung verstanden werden kann.

- Was ein Pfeil aussagt.

- Was in einem Graphen Eltern und Kinder sind.

- Was unter einem Kausalen Modell verstanden werden kann.

- Das es einen Unterschied zwischen beobachten und handeln gibt.


## Ursache und Wirkung

Seit Urzeiten machen wir uns Gedanken über Ursache und Wirkung. Nicht nur in Philosophie, sondern auch ganz praktisch, im täglichen Leben:

- Wenn ich die Tablette nehme, gehen die Schmerzen dann weg?

- Führt die Werbung zu mehr Umsatz?

- Lohnt es sich finanziell an der Fortbildung teilzunehmen?

Dabei können wir entweder die Tablette nehmen - oder nicht. Und die Schmerzen können weggehen, oder nicht. Unternehmen können z.B. den Werbeetat steuern, d.h. entscheiden wie viel Geld sie für Werbung ausgeben. Aber auch der Umsatz *variiert*: mal ist er hoch, mal ist er niedrig - und wird i.d.R. in € gemessen. Sie können an der Fortbildung teilnehmen oder nicht. Und Ihr Gehalt kann steigen - oder (leider) nicht.

Es sind jeweils unterschiedliche Werte möglich, z.B. Ja oder Nein, oder $0€$ oder $100€$ - und für diese gibt es unterschiedliche *Wahrscheinlichkeiten*, $Pr$ als engl. Abkürzung von probability. $Pr(\text{Tablette})$ bezeichnet also die Wahrscheinlichkeit, dass eine Tablette genommen wird, $Pr(\text{Schmerzrückgang})$ die Wahrscheinlichkeit, dass die Schmerzen zurückgehen.

```{r ursache, echo=FALSE}
question("Angenomen nach der Einnahme einer Tablette gehen die Schmerzen weg. Wie würden Sie hier Ursache und Wirkung zuordnen?",
         answer("Die Einnahme der Tablette ist die Ursache, der Schmerzrückgang die Wirkung.", correct = TRUE, message = "Die Tablette wurde zuerst eingenommen, danach folgte der Schmerzrückgang."),
         answer("Der Schmerzrückgang ist die Ursache, die Einnahme der Tablette die Wirkung.", message = "Die Tablette wurde zuerst eingenommen, danach folgte der Schmerzrückgang."),
		correct = "Prima, Richtig!",
		incorrect = "Leider falsch."
         )
```

##

<!-- Quelle: https://github.com/TabeaG/Uebungsheft-Apps/blob/master/EinfuehrungWkeitInferenz/02_EinfuehrungWkeitInferenz.Rmd -->

<span style="font-size: 13px; font-weight: bold; margin-top: 20px;">
Gucken wir mal ob die Tablette hilft
</span>

<img src="images/Pillen.jpg" alt="Pillenpackung" width="50%" height="50%">
<!-- style="padding-left:50px;" -->
<span style="font-size: 10px;"><br>
Quelle: [https://pixabay.com/illustrations/jar-pills-medicine-bottle-2338584/](Quelle: https://pixabay.com/illustrations/jar-pills-medicine-bottle-2338584/)
</span>

<span style="font-size: 13px; font-weight: bold; margin-top: 20px;">
Nehmen Sie die Tablette? <br> </span>
<span style="font-size: 13px; ">
Klicken Sie an. Versuchen Sie es ruhig mehrmals!
</span> 

```{r, context="render", echo=FALSE}
actionButton("Tablette", "Tablette nehmen", class="btn action-button", style="color: #FFF; background-color: #301a87; border-color: #301a87; order-radius: 10px; border-width: 2px")
```
```{r, context="render", echo=FALSE}
actionButton("kTablette", "Tablette nicht nehmen", class="btn action-button", style="color: #FFF; background-color: #301a87; border-color: #301a87; order-radius: 10px; border-width: 2px")
```


```{r, context="render", echo=FALSE}
htmlOutput("ergebnis")
```

```{r, context="server"}
values <- reactiveValues()
values$text <- ""
p.tablette <- observeEvent(input$Tablette, {
  heilung <- sample(c("Ja", "Nein"), 1, prob = c(0.9,0.1))
  ergebnis <- ifelse(heilung == "Ja", "Sie haben die Tablette genommen und die Schmerzen sind zurückgegangen!", "Sie haben die Tablette genommen und die Schmerzen sind leider nicht zurückgegangen!")
  output$ergebnis <- renderText({
    ergebnis
  })
  
})
p.ktablette <- observeEvent(input$kTablette, {
  heilung <- sample(c("Ja", "Nein"), 1, prob = c(0.4,0.6))
  ergebnis <- ifelse(heilung == "Ja", "Sie haben die Tablette nicht genommen und die Schmerzen sind trotzdem zurückgegangen!", "Sie haben die Tablette nicht genommen und die Schmerzen sind leider auch nicht zurückgegangen!")
  output$ergebnis <- renderText({
    ergebnis
  })
  
})
```

<br>


##

Auf einer abstrakteren Ebene können die untersuchten Eigenschaften von oben als *Variablen* aufgefasst werden, also z.B.

- $X$: Tabletteneinnahme Ja oder Nein.

- $Y$: Schmerzrückgang Ja oder Nein.

Die sogenannte *Verteilung* der Variablen beschreibt die Wahrscheinlichkeit, mit der die jeweiligen Werte auftreten. 

Eine Variable $X$ heißt hier **Ursache** von $Y$, wenn der Wert des **Wirkung** $Y$ von $X$ verändert wird, d.h. $Y$ von $X$ abhängt.

Wenn Sie eben mehrfach die Tablette genommen haben - oder nicht genommen haben - dann konnten Sie beobachten, dass die Tablette häufig zu einer Schmerzreduktion führte, aber nicht immer. Und manchmal sind die Schmerzen zurückgegangen, obwohl Sie keine Tablette genommen haben. Die (hinterlegten) Wahrscheinlichkeiten dabei waren:

- $Pr(\text{Schmerzrückgang wenn Tablette eingenommen})=0.9$ - und damit $Pr(\text{Kein Schmerzrückgang wenn Tablette eingenommen})=1-0.9=0.1$

- $Pr(\text{Schmerzrückgang wenn keine Tablette eingenommen})=0.4$ - und damit $Pr(\text{Kein Schmerzrückgang wenn keine Tablette eingenommen})=1-0.4=0.6$

## Graphische Darstellung

Dass die Verteilung von $Y$ auf $X$ *hört*, lässt sich auch graphisch darstellen:

```{r DAG1, echo=FALSE, fig.align='center', out.width='60%'}
plot(DAG1)
```

In einem solchen **Graphen** sind die Variablen <green> Tabletteneinnahme </green> und <blue> Schmerzrückgang </blue> die sog. **Knoten**. Der **Pfeil** $\rightarrow$ zwischen $\color{green}{X}$ und $\color{blue}{Y}$ ist eine gerichtete **Kante** und stellt die kausale Abhängikeit dar.

$\color{green}{X} \rightarrow \color{blue}{Y}$ bedeutet aber auch, dass der Wert von $\color{green}{X}$ nicht vom Wert von $\color{blue}{Y}$ kausal abhängt. Ein möglicher <blue> Schmerzrückgang </blue> ändert nicht rückwirkend die <green> Tabletteneinnahme </green>: $$\color{green}{\text{Tabletteneinnahme}} \not\leftarrow \color{blue}{\text{Schmerzrückgang}}.$$


```{r modell, echo=FALSE}
question("Welches kausale Diagramm beschreibt den Zusammenhang zwischen Lichtschalter und Glühlampe?",
         answer("$\\text{Glühlampe} \\rightarrow \\text{Lichtschalter}$", message = "Lichtschalter an oder aus ist die Ursache für die Wirkung, ob die Glühlampe an oder aus ist. Bei kaputter Leitung oder Lampe ist diese nicht an, obwohl der Schalter an ist. Aber ohne Rückkopplung geht der Schalter nicht aus wenn die Lampe aufgrund eines Schadens nicht an ist."),
         answer("$\\text{Lichtschalter} \\rightarrow \\text{Glühlampe}$", correct = TRUE, message = "Lichtschalter an oder aus ist die Ursache für die Wirkung, ob die Glühlampe an oder aus ist. Bei kaputter Leitung oder Lampe ist diese nicht an, obwohl der Schalter an ist. Aber ohne Rückkopplung geht der Schalter nicht aus wenn die Lampe aufgrund eines Schadens nicht an ist."),
		correct = "Stimmt!",
		incorrect = "Leider falsch."
         )
```

## Hinweis

<red> **Dieser Kurs ist aktuell noch in der Entwicklung!** </red>

Bitte melden Sie Fehler, Unklarheiten und Verbesserungsvorschläge [hier](https://github.com/luebby/WWWEKI/issues).

Das Vorhaben *Was, wie, warum? Einstiegskurs Kausale Inferenz (WWWEKI)* wird mit Mitteln des Bundesministeriums für Bildung und Forschung unter dem Förderkennzeichen 16DHBQP040 gefördert.


![Logo BMBF](images/csm_Logo-BMBF.jpg)


